# Icon registry guardrails (single source of truth)

- Canonical icon mappings live in `server/shared/icon-registry.js`.
- Do not add or edit icon key lists directly in:
  - `server/public/theme-settings.js`
  - `server/public/fontawesome-icons.js`
  - `server/routes/settings.js`
- For icon changes:
  1. Update `ICON_GLYPH_DEFAULTS` (and legacy/locked lists if needed) in `server/shared/icon-registry.js`.
  2. Ensure `/icon-registry.js` payload still hydrates frontend consumers.
  3. Run `npm test` and confirm `test/icon-registry-sync.test.js` passes.
- Backend theme icon whitelist must stay generated from `getThemeIconGlyphSettingKeys()`; never hardcode `theme_icon_glyph_*` lists again.
- If you add a new active runtime icon key, include it in `REQUIRED_ACTIVE_ICON_KEYS` when it is business-critical (for example nav/admin/footer controls that should never drift).
