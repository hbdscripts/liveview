{
  "generatedAt": "2026-02-14",
  "timezone": "Europe/London",
  "notes": [
    "This file is an inventory/mapping for analytics reporting: UI pages -> tables/charts -> API endpoints -> server handlers -> DB tables/queries.",
    "Line numbers are approximate and may drift; rely on file paths + function names as the stable identifiers."
  ],
  "pages": [
    {
      "route": "/dashboard/overview",
      "dataPage": "dashboard",
      "template": "server/public/dashboard/overview.html",
      "scripts": [
        "server/public/kexo-table-builder.js",
        "server/public/kexo-table-defs.js",
        "server/public/kexo-chart-defs.js",
        "server/public/kexo-chart-builder.js",
        "server/public/app.js",
        "server/public/theme-settings.js"
      ],
      "tables": [
        {
          "tableId": "dash-top-products",
          "mount": "#dash-top-products-mount[data-kexo-table=\"dash-top-products\"]",
          "columns": [
            {
              "label": "Product",
              "uiCell": "product title link (modal-capable)",
              "responseFields": ["topProducts[].title", "topProducts[].handle", "topProducts[].product_id"]
            },
            {
              "label": "Revenue",
              "uiCell": "GBP currency",
              "responseFields": ["topProducts[].revenue"],
              "definitionObservedInCode": "Sum of Shopify truth paid line item revenue for orders containing this product (GBP). Source: orders_shopify_line_items.line_revenue, grouped by product_id, within range."
            },
            {
              "label": "Orders",
              "uiCell": "count",
              "responseFields": ["topProducts[].orders"],
              "definitionObservedInCode": "COUNT(DISTINCT order_id) for paid, non-cancelled, non-test Shopify truth orders containing this product."
            },
            {
              "label": "CR%",
              "uiCell": "percent or \u2014",
              "responseFields": ["topProducts[].cr", "topProducts[].sessions"],
              "definitionObservedInCode": "Orders / tracked product landing sessions \u00d7 100. Null when denominator is 0/unknown."
            }
          ],
          "api": {
            "method": "GET",
            "path": "/api/dashboard-series",
            "params": [
              { "name": "range", "source": "getStatsRange() via app.js dashRangeKeyFromDateRange()", "example": "today|7d|14d|30d|d:YYYY-MM-DD|r:YYYY-MM-DD:YYYY-MM-DD" }
            ],
            "responsePath": "topProducts[]",
            "renderer": { "file": "server/public/app.js", "function": "renderDashboard()", "notes": "Renders native table rows into #dash-top-products tbody." },
            "handler": { "file": "server/routes/dashboardSeries.js", "export": "getDashboardSeries" }
          }
        },
        {
          "tableId": "dash-top-countries",
          "mount": "#dash-top-countries-mount[data-kexo-table=\"dash-top-countries\"]",
          "columns": [
            { "label": "Country", "responseFields": ["topCountries[].country"] },
            { "label": "Revenue", "responseFields": ["topCountries[].revenue"] },
            { "label": "Orders", "responseFields": ["topCountries[].orders"] },
            { "label": "CR%", "responseFields": ["topCountries[].cr", "topCountries[].sessions"] }
          ],
          "api": {
            "method": "GET",
            "path": "/api/dashboard-series",
            "params": [{ "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }],
            "responsePath": "topCountries[]",
            "renderer": { "file": "server/public/app.js", "function": "renderDashboard()", "notes": "Renders native table rows into #dash-top-countries tbody." },
            "handler": { "file": "server/routes/dashboardSeries.js", "export": "getDashboardSeries" }
          }
        },
        {
          "tableId": "dash-trending-up",
          "mount": "#dash-trending-up-mount[data-kexo-table=\"dash-trending-up\"]",
          "columns": [
            { "label": "Product", "responseFields": ["trendingUp[].title", "trendingUp[].handle", "trendingUp[].product_id"] },
            { "label": "Revenue", "responseFields": ["trendingUp[].deltaRevenue"] },
            { "label": "Orders", "responseFields": ["trendingUp[].deltaOrders"] },
            { "label": "CR%", "responseFields": ["trendingUp[].cr"] }
          ],
          "api": {
            "method": "GET",
            "path": "/api/dashboard-series",
            "params": [{ "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }],
            "responsePath": "trendingUp[]",
            "renderer": { "file": "server/public/app.js", "function": "renderTrendingTable()", "notes": "Renders native table rows into #dash-trending-up tbody." },
            "handler": { "file": "server/routes/dashboardSeries.js", "export": "getDashboardSeries" }
          }
        },
        {
          "tableId": "dash-trending-down",
          "mount": "#dash-trending-down-mount[data-kexo-table=\"dash-trending-down\"]",
          "columns": [
            { "label": "Product", "responseFields": ["trendingDown[].title", "trendingDown[].handle", "trendingDown[].product_id"] },
            { "label": "Revenue", "responseFields": ["trendingDown[].deltaRevenue"] },
            { "label": "Orders", "responseFields": ["trendingDown[].deltaOrders"] },
            { "label": "CR%", "responseFields": ["trendingDown[].cr"] }
          ],
          "api": {
            "method": "GET",
            "path": "/api/dashboard-series",
            "params": [{ "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }],
            "responsePath": "trendingDown[]",
            "renderer": { "file": "server/public/app.js", "function": "renderTrendingTable()", "notes": "Renders native table rows into #dash-trending-down tbody." },
            "handler": { "file": "server/routes/dashboardSeries.js", "export": "getDashboardSeries" }
          }
        }
      ],
      "charts": [
        {
          "chartKey": "dash-chart-revenue",
          "container": "#dash-chart-revenue",
          "api": { "method": "GET", "path": "/api/dashboard-series", "params": [{ "name": "range", "source": "getStatsRange()" }], "responseFields": ["series[].revenue"] }
        },
        {
          "chartKey": "dash-chart-orders",
          "container": "#dash-chart-orders",
          "api": { "method": "GET", "path": "/api/dashboard-series", "params": [{ "name": "range", "source": "getStatsRange()" }], "responseFields": ["series[].orders"] }
        },
        {
          "chartKey": "dash-chart-conv",
          "container": "#dash-chart-conv",
          "api": { "method": "GET", "path": "/api/dashboard-series", "params": [{ "name": "range", "source": "getStatsRange()" }], "responseFields": ["series[].convRate", "series[].shopifyConvRate"] }
        },
        {
          "chartKey": "dash-chart-sessions",
          "container": "#dash-chart-sessions",
          "api": { "method": "GET", "path": "/api/dashboard-series", "params": [{ "name": "range", "source": "getStatsRange()" }], "responseFields": ["series[].sessions"] }
        },
        {
          "chartKey": "dash-chart-adspend",
          "container": "#dash-chart-adspend",
          "api": { "method": "GET", "path": "/api/dashboard-series", "params": [{ "name": "range", "source": "getStatsRange()" }], "responseFields": ["series[].adSpend", "series[].revenue"] }
        }
      ],
      "kpis": [
        { "api": { "method": "GET", "path": "/api/kpis", "params": [{ "name": "range", "source": "getStatsRange()" }] }, "uiIds": ["dash-kpi-revenue", "dash-kpi-orders", "dash-kpi-conv", "dash-kpi-aov", "dash-kpi-sessions", "dash-kpi-bounce", "dash-kpi-returning", "dash-kpi-roas"] },
        { "api": { "method": "GET", "path": "/api/kpis-expanded-extra", "params": [{ "name": "range", "source": "getStatsRange()" }] }, "uiIds": ["dash-kpi-cogs", "dash-kpi-fulfilled", "dash-kpi-returns", "dash-kpi-items"] }
      ]
    },
    {
      "route": "/dashboard/live",
      "dataPage": "live",
      "template": "server/public/dashboard/live.html",
      "tables": [
        {
          "tableId": "latest-sales-table",
          "mount": "#latest-sales-mount[data-kexo-table=\"latest-sales-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/latest-sales",
            "params": [{ "name": "limit", "source": "hard-coded", "example": "5" }],
            "responsePath": "sales[]",
            "renderer": { "file": "server/public/app.js", "function": "renderLatestSalesTable()", "notes": "Renders native table in Live View sidebar card." },
            "handler": { "file": "server/routes/sessions.js", "export": "latestSales" }
          }
        },
        {
          "tableId": "sessions-table",
          "mount": "#sessions-table-mount[data-kexo-table=\"sessions-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/sessions",
            "params": [{ "name": "filter", "source": "hard-coded for live", "example": "active" }],
            "responsePath": "sessions[]",
            "renderer": { "file": "server/public/app.js", "function": "fetchSessions() + renderTable()", "notes": "Live mode fetches active sessions, then filters/sorts client-side by last_seen/start." },
            "handler": { "file": "server/routes/sessions.js", "export": "list" }
          }
        }
      ],
      "charts": [
        {
          "chartKey": "live-online-chart",
          "container": "#live-online-chart",
          "api": { "method": "GET", "path": "/api/sessions/online-series", "params": [{ "name": "minutes", "example": "5" }, { "name": "stepMinutes", "example": "1" }] }
        }
      ]
    },
    {
      "route": "/dashboard/sales",
      "dataPage": "sales",
      "template": "server/public/dashboard/sales.html",
      "tables": [
        {
          "tableId": "sessions-table",
          "mount": "#sessions-table-mount[data-kexo-table=\"sessions-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/sessions",
            "params": [
              { "name": "range", "source": "page default", "example": "sales" },
              { "name": "limit", "source": "rowsPerPage", "example": "25" },
              { "name": "offset", "source": "currentPage", "example": "0" },
              { "name": "timezone", "source": "tz constant in app.js", "example": "Europe/London" }
            ],
            "responsePath": "sessions[]",
            "renderer": { "file": "server/public/app.js", "function": "fetchSessions() + renderTable()", "notes": "Range mode fetches paginated sessions for selected range." },
            "handler": { "file": "server/routes/sessions.js", "export": "list" }
          }
        }
      ],
      "charts": [
        {
          "chartKey": "sales-overview-chart",
          "container": "#sessions-overview-chart",
          "api": { "method": "GET", "path": "/api/dashboard-series", "params": [{ "name": "range", "source": "getStatsRange()", "example": "sales|today|7d|r:..." }] }
        }
      ]
    },
    {
      "route": "/dashboard/table",
      "dataPage": "date",
      "template": "server/public/dashboard/table.html",
      "tables": [
        {
          "tableId": "sessions-table",
          "mount": "#sessions-table-mount[data-kexo-table=\"sessions-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/sessions",
            "params": [
              { "name": "range", "source": "normalizeRangeKeyForApi(dateRange)", "example": "today|yesterday|7d|d:...|r:..." },
              { "name": "limit", "source": "rowsPerPage", "example": "25" },
              { "name": "offset", "source": "currentPage", "example": "0" },
              { "name": "timezone", "source": "tz constant in app.js", "example": "Europe/London" }
            ],
            "responsePath": "sessions[]",
            "renderer": { "file": "server/public/app.js", "function": "fetchSessions() + renderTable()" },
            "handler": { "file": "server/routes/sessions.js", "export": "list" }
          }
        }
      ],
      "charts": [
        {
          "chartKey": "date-overview-chart",
          "container": "#sessions-overview-chart",
          "api": { "method": "GET", "path": "/api/dashboard-series", "params": [{ "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }] }
        }
      ]
    },
    {
      "route": "/insights/countries",
      "dataPage": "countries",
      "template": "server/public/insights/countries.html",
      "tables": [
        {
          "tableId": "country-table",
          "mount": "#country-table-mount[data-kexo-table=\"country-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/stats",
            "params": [{ "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }],
            "responsePath": "country[rangeKey][]",
            "renderer": { "file": "server/public/app.js", "function": "renderCountry()", "notes": "Reads statsCache.country[getStatsRange()]." },
            "handler": { "file": "server/routes/stats.js", "export": "getStats" }
          }
        },
        {
          "tableId": "best-geo-products-table",
          "mount": "#best-geo-products-mount[data-kexo-table=\"best-geo-products-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/stats",
            "params": [{ "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }],
            "responsePath": "bestGeoProducts[rangeKey][]",
            "renderer": { "file": "server/public/app.js", "function": "renderBestGeoProducts()", "notes": "Reads statsCache.bestGeoProducts[getStatsRange()]." },
            "handler": { "file": "server/routes/stats.js", "export": "getStats" }
          }
        }
      ],
      "charts": [
        {
          "chartKey": "countries-map-chart",
          "container": "#countries-map-chart",
          "api": { "method": "GET", "path": "/api/stats", "params": [{ "name": "range", "source": "getStatsRange()" }] }
        }
      ]
    },
    {
      "route": "/insights/products",
      "dataPage": "products",
      "template": "server/public/insights/products.html",
      "tables": [
        {
          "tableId": "best-sellers-table",
          "mount": "#best-sellers-mount[data-kexo-table=\"best-sellers-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/shopify-best-sellers",
            "params": [
              { "name": "shop", "source": "getShopParam() / getShopForSales()", "example": "store.myshopify.com" },
              { "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." },
              { "name": "page", "source": "bestSellersPage", "example": "1" },
              { "name": "pageSize", "source": "tablesUiConfig rowsPerPage", "example": "10" },
              { "name": "sort", "source": "bestSellersSortBy", "example": "rev|orders|clicks|cr|title" },
              { "name": "dir", "source": "bestSellersSortDir", "example": "asc|desc" }
            ],
            "responsePath": "bestSellers[]",
            "renderer": { "file": "server/public/app.js", "function": "fetchBestSellers() + renderBestSellers()" },
            "handler": { "file": "server/routes/shopifyBestSellers.js", "export": "getShopifyBestSellers" }
          }
        },
        {
          "tableId": "best-variants-table",
          "mount": "#best-variants-mount[data-kexo-table=\"best-variants-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/shopify-best-variants",
            "params": [
              { "name": "shop", "source": "getShopParam() / getShopForSales()", "example": "store.myshopify.com" },
              { "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." },
              { "name": "page", "source": "bestVariantsPage", "example": "1" },
              { "name": "pageSize", "source": "tablesUiConfig rowsPerPage", "example": "10" }
            ],
            "responsePath": "bestVariants[]",
            "renderer": { "file": "server/public/app.js", "function": "fetchBestVariants() + renderBestVariants()" },
            "handler": { "file": "server/routes/shopifyBestVariants.js", "export": "getShopifyBestVariants" }
          }
        },
        {
          "tableId": "type-*-table",
          "mounts": [
            "#type-necklaces-mount",
            "#type-bracelets-mount",
            "#type-earrings-mount",
            "#type-sets-mount",
            "#type-charms-mount",
            "#type-extras-mount"
          ],
          "api": {
            "method": "GET",
            "path": "/api/shopify-leaderboard",
            "params": [
              { "name": "shop", "source": "getShopParam() / getShopForSales()", "example": "store.myshopify.com" },
              { "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." },
              { "name": "topProducts", "source": "PRODUCTS_LEADERBOARD_FETCH_LIMIT", "example": "50" },
              { "name": "topTypes", "source": "PRODUCTS_LEADERBOARD_FETCH_LIMIT", "example": "50" }
            ],
            "responsePath": "productsByType.*",
            "renderer": { "file": "server/public/app.js", "function": "fetchProductsLeaderboard() + renderAllTypeTables()", "notes": "Renders per-type product tables using shared PRODUCT_COLS." },
            "handler": { "file": "server/routes/shopifyLeaderboard.js", "export": "getShopifyLeaderboard" }
          }
        }
      ],
      "charts": [
        {
          "chartKey": "products-chart",
          "container": "#products-chart",
          "api": { "method": "GET", "path": "/api/shopify-best-sellers", "params": [{ "name": "shop", "source": "getShopParam()" }, { "name": "range", "source": "getStatsRange()" }] }
        }
      ]
    },
    {
      "route": "/insights/variants",
      "dataPage": "variants",
      "template": "server/public/insights/variants.html",
      "tables": [
        {
          "tableId": "variants-dynamic-tables",
          "mount": "#variants-tables-row",
          "api": {
            "method": "GET",
            "path": "/api/insights-variants",
            "params": [
              { "name": "shop", "source": "store-base-url payload shopForSales", "example": "store.myshopify.com" },
              { "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }
            ],
            "responsePath": "tables[]",
            "renderer": { "file": "server/public/variants-page.js", "function": "fetchInsightsVariants() + render", "notes": "Tables rendered dynamically per insightsVariantsConfig." },
            "handler": { "file": "server/routes/insightsVariants.js", "export": "getInsightsVariants" }
          }
        }
      ]
    },
    {
      "route": "/traffic/channels",
      "dataPage": "channels",
      "template": "server/public/traffic/channels.html",
      "tables": [
        {
          "tableId": "traffic-sources-table",
          "mount": "#traffic-sources-mount[data-kexo-table=\"traffic-sources-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/traffic",
            "params": [{ "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }],
            "responsePath": "sources.rows[]",
            "renderer": { "file": "server/public/app.js", "function": "refreshTraffic() + renderTrafficTables()", "notes": "Renders traffic sources (channels) table and chart." },
            "handler": { "file": "server/routes/traffic.js", "export": "getTraffic" }
          }
        }
      ],
      "charts": [
        { "chartKey": "channels-chart", "container": "#channels-chart", "api": { "method": "GET", "path": "/api/traffic", "params": [{ "name": "range", "source": "getStatsRange()" }] } }
      ]
    },
    {
      "route": "/traffic/device",
      "dataPage": "type",
      "template": "server/public/traffic/device.html",
      "tables": [
        {
          "tableId": "traffic-types-table",
          "mount": "#traffic-types-mount[data-kexo-table=\"traffic-types-table\"]",
          "api": {
            "method": "GET",
            "path": "/api/traffic",
            "params": [{ "name": "range", "source": "getStatsRange()", "example": "today|7d|r:..." }],
            "responsePath": "types.rows[]",
            "renderer": { "file": "server/public/app.js", "function": "refreshTraffic() + renderTrafficTables()", "notes": "Renders traffic types (device/platform) table and chart." },
            "handler": { "file": "server/routes/traffic.js", "export": "getTraffic" }
          }
        }
      ],
      "charts": [
        { "chartKey": "type-chart", "container": "#type-chart", "api": { "method": "GET", "path": "/api/traffic", "params": [{ "name": "range", "source": "getStatsRange()" }] } }
      ]
    },
    {
      "route": "/integrations/google-ads",
      "dataPage": "ads",
      "template": "server/public/integrations/google-ads.html",
      "tables": [
        {
          "tableId": "ads-root",
          "mount": "#ads-root",
          "api": {
            "method": "GET",
            "path": "/api/ads/summary",
            "params": [{ "name": "range", "source": "getStatsRange() normalization", "example": "7d|14d|30d|r:..." }],
            "responsePath": "campaigns[]",
            "renderer": { "file": "server/public/ads.js", "function": "render()", "notes": "Renders campaigns table into #ads-root; totals/footer into #ads-footer." },
            "handler": { "file": "server/routes/ads.js", "export": "router (mounted at /api/ads)" }
          }
        }
      ],
      "charts": [
        { "chartKey": "ads-overview-chart", "container": "#ads-overview-chart", "api": { "method": "GET", "path": "/api/ads/summary", "params": [{ "name": "range", "source": "getStatsRange() normalization" }] } }
      ]
    },
    {
      "route": "/tools/compare-conversion-rate",
      "dataPage": "compare-conversion-rate",
      "template": "server/public/tools/compare-conversion-rate.html",
      "tables": [
        {
          "tableId": "tools-compare-cr-table",
          "mount": "#results (dynamic)",
          "api": {
            "method": "POST",
            "path": "/api/tools/compare-cr/compare",
            "params": [{ "name": "JSON body", "source": "tools.js form state" }],
            "renderer": { "file": "server/public/tools.js", "function": "compare() + renderResults()", "notes": "Builds a KEXO_TOOLS_TABLE_DEFS table into results container." },
            "handler": { "file": "server/routes/tools.js", "export": "router (mounted at /api/tools)" }
          }
        }
      ]
    },
    {
      "route": "/tools/shipping-cr",
      "dataPage": "shipping-cr",
      "template": "server/public/tools/shipping-cr.html",
      "tables": [
        {
          "tableId": "tools-shipping-cr-table",
          "mount": "#results (dynamic)",
          "api": {
            "method": "POST",
            "path": "/api/tools/shipping-cr/labels",
            "params": [{ "name": "JSON body", "source": "tools-shipping-cr.js form state" }],
            "renderer": { "file": "server/public/tools-shipping-cr.js", "function": "go() + renderResults()", "notes": "Builds a KEXO_TOOLS_TABLE_DEFS table into results container." },
            "handler": { "file": "server/routes/tools.js", "export": "router (mounted at /api/tools)" }
          }
        }
      ]
    }
  ],
  "endpoints": [
    {
      "method": "GET",
      "path": "/api/dashboard-series",
      "handler": { "file": "server/routes/dashboardSeries.js", "export": "getDashboardSeries" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 300000, "note": "Route uses reportCache; exact TTL may vary by key." }],
      "dbTables": [
        "sessions",
        "events",
        "orders_shopify",
        "orders_shopify_line_items",
        "shopify_sessions_snapshots",
        "google_ads_spend_hourly"
      ],
      "usedByPages": ["/dashboard/overview", "/dashboard/sales", "/dashboard/table"]
    },
    {
      "method": "GET",
      "path": "/api/stats",
      "handler": { "file": "server/routes/stats.js", "export": "getStats" },
      "rangeHandling": { "helper": "store.getStats({ rangeKey }) -> store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [
        { "layer": "server/routes/stats.js statsMemoByKey", "ttlMs": 30000 },
        { "layer": "server/reportCache.js", "ttlMs": 900000 }
      ],
      "dbTables": ["sessions", "events", "orders_shopify", "orders_shopify_line_items", "purchases", "purchase_events"],
      "usedByPages": ["/insights/countries"]
    },
    {
      "method": "GET",
      "path": "/api/kpis",
      "handler": { "file": "server/routes/kpis.js", "export": "getKpis" },
      "rangeHandling": { "helper": "store.getKpis()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 120000 }],
      "dbTables": ["sessions", "events", "orders_shopify", "orders_shopify_line_items", "google_ads_spend_hourly"],
      "usedByPages": ["(all pages via header KPI strip)", "/dashboard/overview"]
    },
    {
      "method": "GET",
      "path": "/api/kpis-expanded-extra",
      "handler": { "file": "server/routes/kpisExpandedExtra.js", "export": "getKpisExpandedExtra" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 600000 }],
      "dbTables": ["orders_shopify", "orders_shopify_line_items"],
      "usedByPages": ["(all pages via header KPI strip)", "/dashboard/overview"]
    },
    {
      "method": "GET",
      "path": "/api/sessions",
      "handler": { "file": "server/routes/sessions.js", "export": "list" },
      "rangeHandling": { "helper": "store.listSessionsByRange()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [],
      "dbTables": ["sessions"],
      "usedByPages": ["/dashboard/live", "/dashboard/sales", "/dashboard/table"]
    },
    {
      "method": "GET",
      "path": "/api/sessions/online-series",
      "handler": { "file": "server/routes/sessions.js", "export": "onlineSeries" },
      "cache": [],
      "dbTables": ["sessions"],
      "usedByPages": ["/dashboard/live"]
    },
    {
      "method": "GET",
      "path": "/api/sessions/:id/events",
      "handler": { "file": "server/routes/sessions.js", "export": "events" },
      "cache": [],
      "dbTables": ["events"],
      "usedByPages": ["/dashboard/live", "/dashboard/sales", "/dashboard/table"]
    },
    {
      "method": "GET",
      "path": "/api/latest-sales",
      "handler": { "file": "server/routes/sessions.js", "export": "latestSales" },
      "cache": [],
      "dbTables": ["orders_shopify", "purchase_events", "sessions"],
      "usedByPages": ["/dashboard/live"]
    },
    {
      "method": "GET",
      "path": "/api/traffic",
      "handler": { "file": "server/routes/traffic.js", "export": "getTraffic" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 300000 }],
      "dbTables": ["sessions", "orders_shopify"],
      "usedByPages": ["/traffic/channels", "/traffic/device"]
    },
    {
      "method": "GET",
      "path": "/api/shopify-best-sellers",
      "handler": { "file": "server/routes/shopifyBestSellers.js", "export": "getShopifyBestSellers" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 600000 }],
      "dbTables": ["orders_shopify_line_items", "sessions"],
      "usedByPages": ["/insights/products"]
    },
    {
      "method": "GET",
      "path": "/api/shopify-best-variants",
      "handler": { "file": "server/routes/shopifyBestVariants.js", "export": "getShopifyBestVariants" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 600000 }],
      "dbTables": ["orders_shopify_line_items", "sessions"],
      "usedByPages": ["/insights/products"]
    },
    {
      "method": "GET",
      "path": "/api/shopify-leaderboard",
      "handler": { "file": "server/routes/shopifyLeaderboard.js", "export": "getShopifyLeaderboard" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 600000 }],
      "dbTables": ["orders_shopify_line_items", "sessions"],
      "usedByPages": ["/insights/products"]
    },
    {
      "method": "GET",
      "path": "/api/insights-variants",
      "handler": { "file": "server/routes/insightsVariants.js", "export": "getInsightsVariants" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 300000 }],
      "dbTables": ["orders_shopify_line_items", "sessions"],
      "usedByPages": ["/insights/variants"]
    },
    {
      "method": "GET",
      "path": "/api/product-insights",
      "handler": { "file": "server/routes/productInsights.js", "export": "getProductInsights" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 300000, "note": "Per-product; lifetime details cached longer." }],
      "dbTables": ["orders_shopify_line_items", "orders_shopify", "sessions", "events"],
      "usedByPages": ["(modal opened from multiple tables via js-product-modal-link)"]
    },
    {
      "method": "GET",
      "path": "/api/page-insights",
      "handler": { "file": "server/routes/pageInsights.js", "export": "getPageInsights" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [],
      "dbTables": ["sessions", "events"],
      "usedByPages": ["(page insights modal in app.js)"]
    },
    {
      "method": "GET",
      "path": "/api/ads/summary",
      "handler": { "file": "server/routes/ads.js", "export": "router (mounted at /api/ads)" },
      "rangeHandling": { "helper": "store.getRangeBounds()", "timezone": "store.resolveAdminTimeZone()", "bounds": "[start, end)" },
      "cache": [],
      "dbTables": ["google_ads_spend_hourly", "ads_orders_attributed"],
      "usedByPages": ["/integrations/google-ads", "/tools/ads"]
    },
    {
      "method": "POST",
      "path": "/api/tools/compare-cr/compare",
      "handler": { "file": "server/routes/tools.js", "export": "router (mounted at /api/tools)" },
      "cache": [],
      "dbTables": ["sessions", "orders_shopify_line_items"],
      "usedByPages": ["/tools/compare-conversion-rate"]
    },
    {
      "method": "POST",
      "path": "/api/tools/shipping-cr/labels",
      "handler": { "file": "server/routes/tools.js", "export": "router (mounted at /api/tools)" },
      "cache": [{ "layer": "server/reportCache.js", "ttlMs": 300000 }],
      "dbTables": ["orders_shopify_shipping_options", "sessions"],
      "usedByPages": ["/tools/shipping-cr"]
    }
  ]
}

