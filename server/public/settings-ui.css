/* Settings/Admin UI contract helpers (Tabler-first).
   This file is Settings-only and is included only on /settings. */

/* Panel wrapper: joins to nav-tabs/accordion above; softened framing. */
.settings-panel-wrap {
  border-left: 1px solid var(--tblr-border-color-translucent, rgba(0, 0, 0, 0.06));
  border-right: 1px solid var(--tblr-border-color-translucent, rgba(0, 0, 0, 0.06));
  border-bottom: 1px solid var(--tblr-border-color-translucent, rgba(0, 0, 0, 0.06));
  border-top: 0;
  border-radius: 0 0 var(--tblr-border-radius, .75rem) var(--tblr-border-radius, .75rem);
  padding: 0.875rem 1rem;
  margin-top: -1px;
  background: var(--tblr-bg-surface, #fff);
}

/* Consistent framed container directly under Settings in-panel tab bars. */
body[data-page="settings"] .settings-tab-content-box {
  border: 1px solid var(--tblr-border-color-translucent, rgba(0, 0, 0, 0.06));
  border-radius: 0 0 var(--tblr-border-radius, .75rem) var(--tblr-border-radius, .75rem);
  padding: 0.875rem 1rem;
  margin-top: 0;
  background: var(--tblr-bg-surface, #fff);
}

/* Nullify extra outer wrappers inside the join container (avoid double frames/padding). */
body[data-page="settings"] .settings-tab-content-box > .settings-main-tabs-accordion {
  border: 0;
  margin: 0;
  padding: 0;
  background: transparent;
}
body[data-page="settings"] .settings-tab-content-box > .settings-main-tabs-accordion > .accordion-item {
  border: 0;
  margin: 0;
  padding: 0;
  background: transparent;
}
body[data-page="settings"] .settings-tab-content-box > .settings-main-tabs-accordion > .accordion-item > .accordion-collapse > .accordion-body {
  border: 0;
  margin: 0;
  padding: 0;
  background: transparent;
}

/* Flatten wrapper cards inside panels to avoid "container inside container" framing. */
body[data-page="settings"] .settings-flat-card {
  border: 0 !important;
  box-shadow: none !important;
  background: transparent !important;
  margin: 0 !important;
}
body[data-page="settings"] .settings-flat-card > .card-body,
body[data-page="settings"] .settings-flat-card-body {
  border: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
  background: transparent !important;
}

/* Cost & profit panels are not accordion-framed; use the shared tab box frame instead. */
body[data-page="settings"] #settings-panel-cost-expenses .settings-tab-content-box .settings-panel-wrap {
  border: 0;
  border-radius: 0;
  padding: 0;
  margin-top: 0;
  background: transparent;
}

/* Left nav: category and child links (Settings-only). */
.settings-nav-category { margin-bottom: 0.15rem; margin-right: 10px; }
.settings-nav-category > .list-group-item:first-child {
  border-radius: var(--tblr-border-radius, .375rem);
  padding: 0;
  min-height: 30px;
  line-height: 30px;
  text-indent: 15px;
  font-weight: 600;
  color: var(--kexo-settings-nav-category-color, var(--tblr-body-color, #1f2937)) !important;
}
.settings-nav-children { padding-left: 0; }
.settings-nav-child {
  position: relative;
  padding: 7px 0 7px 40px;
  color: var(--kexo-settings-nav-child-color, inherit);
}
.settings-nav-child::before {
  content: '›';
  position: absolute;
  left: 25px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--kexo-settings-nav-chevron-color, var(--tblr-body-color, #64748b));
  opacity: 0.5;
  font-size: 0.9em;
  pointer-events: none;
}
.settings-nav-child.active {
  color: var(--kexo-settings-nav-active-color, var(--tblr-primary, #206bc4));
  background: var(--kexo-settings-nav-active-bg, transparent) !important;
}
.settings-nav-child.active::before { opacity: 1; }

/* Moved header controls container when stripping the first card header. */
.settings-card-controls {
  justify-content: flex-end;
}

/* Direct headings inside a panel wrapper. */
.settings-panel-heading {
  font-size: 1rem;
  font-weight: 600;
}

/* Read-only fields should not look editable. */
.settings-readonly-plaintext {
  cursor: default;
}
.settings-readonly-hint {
  margin-top: .25rem;
}

/* Inside accordion bodies, the accordion already provides framing.
   Avoid double padding/borders that make loaders/content look indented. */
body[data-page="settings"] .accordion-body .settings-panel-wrap {
  border: 0;
  border-radius: 0;
  padding: 0;
  margin-top: 0;
  background: transparent;
}

/* Tabs/underlines should visually "touch" the content frame below. */
body[data-page="settings"] .settings-panel-wrap ul.nav {
  margin-bottom: 1px;
}

/* In-panel main tabs (JS-injected + Costs & profit). */
body[data-page="settings"] .settings-main-tabs {
  border: 0;
  margin: 0 0 -1px !important;
  padding: 0 !important;
  gap: 0.35rem;
  position: relative;
  z-index: 3;
}
body[data-page="settings"] .settings-main-tabs .nav-link {
  border: 1px solid transparent;
  border-bottom-color: transparent;
  border-radius: 8px 8px 0 0;
  padding: 10px 15px;
  font-weight: 500;
  font-size: 14px;
  background: var(--tblr-bg-surface-secondary, #f6f8fb);
  color: var(--tblr-secondary, #66758c);
  margin-bottom: 0;
}
body[data-page="settings"] .settings-main-tabs .nav-link:hover {
  color: var(--tblr-body-color, #1f2937);
}
body[data-page="settings"] .settings-main-tabs .nav-link.active {
  background: var(--tblr-bg-surface, #fff);
  border-color: var(--tblr-border-color-translucent, rgba(0, 0, 0, 0.06));
  border-bottom-color: var(--tblr-bg-surface, #fff);
  font-weight: 600;
  position: relative;
  z-index: 2;
  text-decoration: underline;
  text-decoration-thickness: 2px;
  text-underline-offset: 5px;
  text-decoration-color: #555;
}

@media (min-width: 992px) {
  /* Desktop: overlap the join-container border to avoid double borders/overhang. */
  body[data-page="settings"] .settings-main-tabs .nav-link {
    margin-bottom: -1px;
  }
}

@media (max-width: 991.98px) {
  body[data-page="settings"] .settings-main-tabs {
    /* Mobile: overlap a bit more so scroller row meets the border below. */
    margin-bottom: -3px !important;
    flex-wrap: nowrap;
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 0.25rem !important;
  }
  body[data-page="settings"] .settings-main-tabs .nav-item {
    flex: 0 0 auto;
  }
  body[data-page="settings"] .settings-main-tabs .nav-link {
    white-space: nowrap;
  }
}

/* Remove grid-layout drift: charts color “grid” becomes a simple vertical stack. */

/* Shared max-width helpers used by Settings renderers (avoid inline styles). */
.settings-ui-maxw-560 { max-width: 560px; }
.settings-ui-maxw-360 { max-width: 360px; width: 100%; }
.settings-ui-maxw-280 { max-width: 280px; width: 100%; }
.settings-ui-maxw-260 { max-width: 260px; width: 100%; }
.settings-ui-w-5rem { width: 5rem; }
.settings-ui-cursor-pointer { cursor: pointer; }

/* Responsive tile grid used in Settings → Icons & Color Scheme.
   Avoids Bootstrap .row/.col-* so the Settings normaliser doesn't collapse it. */
body[data-page="settings"] .settings-responsive-grid {
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 1rem;
  align-items: start;
}
body[data-page="settings"] .settings-responsive-grid > * { min-width: 0; }
body[data-page="settings"] .settings-responsive-grid .settings-responsive-grid-span-all { grid-column: 1 / -1; }

/* Icons accordion: ensure at least 4 per row on desktop (override any conflicting context). */
body[data-page="settings"] #theme-icons-accordion .settings-responsive-grid {
  display: grid !important;
  grid-template-columns: repeat(4, minmax(0, 1fr)) !important;
  gap: 1rem;
  align-items: start;
}
body[data-page="settings"] #theme-icons-accordion .settings-responsive-grid > * { min-width: 0; }

/* Color overrides rows (Settings → Color Scheme) */
body[data-page="settings"] .kexo-css-var-swatch,
body[data-page="settings"] .theme-accent-swatch {
  width: 2.5rem;
  height: 2rem;
  padding: 2px;
  cursor: pointer;
}
body[data-page="settings"] .kexo-css-var-name {
  word-break: break-all;
  white-space: nowrap;
}
@media (max-width: 575.98px) {
  body[data-page="settings"] .kexo-css-var-name {
    display: none;
  }
}

@media (max-width: 1199.98px) {
  body[data-page="settings"] .settings-responsive-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
  body[data-page="settings"] #theme-icons-accordion .settings-responsive-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); }
}
@media (max-width: 991.98px) {
  body[data-page="settings"] .settings-responsive-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
  body[data-page="settings"] #theme-icons-accordion .settings-responsive-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
}
@media (max-width: 767.98px) {
  body[data-page="settings"] .settings-responsive-grid { grid-template-columns: minmax(0, 1fr); }
  body[data-page="settings"] #theme-icons-accordion .settings-responsive-grid { grid-template-columns: minmax(0, 1fr); }
}
@media (max-width: 575.98px) {
  body[data-page="settings"] .settings-responsive-grid { grid-template-columns: minmax(0, 1fr); }
  body[data-page="settings"] #theme-icons-accordion .settings-responsive-grid { grid-template-columns: minmax(0, 1fr); }
}

/* Icons & assets: click-to-open help popover (trigger at far right of each label). */
.popover.kexo-icon-help-popover {
  max-width: 340px;
  border: 1px solid var(--tblr-border-color, rgba(0, 0, 0, 0.08));
  border-radius: var(--tblr-border-radius, 0.5rem);
  box-shadow: 0 4px 14px rgba(0, 0, 0, 0.08), 0 2px 6px rgba(0, 0, 0, 0.04);
  background: var(--tblr-bg-surface-secondary, #f8f9fa);
}
.popover.kexo-icon-help-popover .popover-header {
  display: none;
}
.popover.kexo-icon-help-popover .popover-body {
  padding: 0;
}
.popover.kexo-icon-help-popover .kexo-icon-help-popover-content {
  position: relative;
  padding: 0.75rem 2rem 0.75rem 1rem;
  min-height: 2.5rem;
}
.popover.kexo-icon-help-popover .kexo-icon-help-popover-close {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  margin: 0;
  padding: 0.25rem;
  opacity: 0.6;
  font-size: 0.75rem;
}
.popover.kexo-icon-help-popover .kexo-icon-help-popover-close:hover {
  opacity: 1;
}
.popover.kexo-icon-help-popover .kexo-icon-help-popover-text {
  font-size: 0.8125rem;
  line-height: 1.45;
  color: var(--tblr-body-color, #1e293b);
  padding-right: 0.5rem;
}
/* Help trigger: icon only, no button look; opacity 0.6, hover 1, no other hover effect. */
.kexo-icon-help-trigger {
  border: none;
  background: none;
  padding: 0;
  margin: 0;
  box-shadow: none;
  opacity: 0.6;
  cursor: pointer;
}
.kexo-icon-help-trigger:hover {
  opacity: 1;
}
.kexo-icon-help-trigger:focus {
  outline: none;
  box-shadow: none;
}
.kexo-icon-help-trigger .kexo-icon-help-trigger-icon {
  width: 16px;
  height: 16px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.kexo-icon-help-trigger .kexo-icon-help-trigger-icon svg {
  width: 16px;
  height: 16px;
}

/* Icon card Edit/Save: icon-only, no border/hover effects; opacity 0.8, hover 1. */
.kexo-icon-action-btn {
  border: none;
  background: transparent;
  padding: 0.25rem;
  box-shadow: none;
  opacity: 0.8;
  transition: none;
}
.kexo-icon-action-btn:hover {
  opacity: 1;
}
.kexo-icon-action-btn:focus {
  box-shadow: none;
  outline: none;
}
.kexo-icon-action-btn .kexo-icon-action-icon {
  width: 16px;
  height: 16px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
.kexo-icon-action-btn .kexo-icon-action-icon svg {
  width: 16px;
  height: 16px;
}

/* Theme settings: icon preview sizes (avoid inline styles). */
body[data-page="settings"] .kexo-theme-icon-preview {
  width: 1.25rem;
  height: 1.25rem;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}
body[data-page="settings"] .theme-icons-attribution-preview {
  width: 1.5rem;
  height: 1.5rem;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/* Click-only help popover (Settings): black bubble, one open at a time, close button. */
.kexo-help-popover {
  position: fixed;
  z-index: 9999;
  max-width: 320px;
  padding: 0.75rem 2rem 0.75rem 1rem;
  background: #1e293b;
  color: #e2e8f0;
  font-size: 0.8125rem;
  line-height: 1.45;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
  pointer-events: auto;
}
.kexo-help-popover .kexo-help-popover-content {
  padding-right: 0.5rem;
}
.kexo-help-popover .kexo-help-popover-close {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  margin: 0;
  padding: 0.25rem;
  opacity: 0.7;
}
.kexo-help-popover .kexo-help-popover-close:hover {
  opacity: 1;
}
[data-kexo-help] {
  cursor: pointer;
}

/* Per-panel save buttons hidden in favor of page-level footer Save Settings. */
.settings-panel-save-hidden {
  display: none !important;
}

